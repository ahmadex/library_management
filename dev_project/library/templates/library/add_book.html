{% extends 'base.html' %}
{% load crispy_forms_tags%}
{% load static %}


  
    {% block content %}
        <div class='heading'style='margin-top:100px;'>
            <center><h1 id='ab'>Welcome To Sign-In Page</h1></center>
        </div>
        <div class='jumbotron container' style='width:60%;'>
            <form id='bookform' class='form1' name='signin' method='post' enctype='multipart/form-data'>
                {% csrf_token %}
                {% comment %} {{bookform|crispy}} {% endcomment %}
                {{bookform.title|as_crispy_field}}
                {{bookform.category|as_crispy_field}}
                {{bookform.author|as_crispy_field}}
                {{bookform.description|as_crispy_field}}
                {{bookform.no_of_copy|as_crispy_field}}
                {{bookform.available_copy|as_crispy_field}}
                {{bookform.cover_page|as_crispy_field}}
                <br>
                <input class='btn btn-primary' type='submit',value='Signin', name='submit'>
            </form>
        </div>

        
{% endblock %}

{% block javascript %} 
    <script type='text/javascript'>
    $(function(){
        
        let x = $('#id_no_of_copy');
        x.after(`<a href="#" id='plus' class="btn btn-primary btn-lg">+</a>`);
        x.after(`<a href="#" id='minus' class="btn btn-danger btn-lg">-</a>`);
        let y = $('#id_available_copy');
        y.attr("disabled","disabled");
        x.attr("disabled","disabled");

        $('#plus').on('click',function(){
            console.log({{books.id}})
            $.ajax({
                url:`{% url 'library:copy_incrmt'%}`,
                method:'POST',
                data: {
                    id:{{books.id}},
                    csrfmiddlewaretoken: '{{csrf_token}}',
                },
                success: function(data){
                    console.log(data.status)
                    if(data.status == "1"){
                        x.val(data.book_copy);
                        y.val(data.avail);

                    }
                }
            })
        });


// no of copy decreament
    $('#minus').on('click',function(){
            console.log({{books.id}})
            $.ajax({
                url:`{% url 'library:copy_dcrmt'%}`,
                method:'POST',
                data: {
                    id:{{books.id}},
                    csrfmiddlewaretoken: '{{csrf_token}}',
                },
                success: function(data){
                    console.log(data.status)
                    if(data.status == "1"){
                        x.val(data.book_copy);
                        y.val(data.avail);

                    }
                }
            })
        });

    });

    </script>
{% endblock %}
